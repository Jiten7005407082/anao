<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RideEase - Ride Hailing Service</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #4a89dc;
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
        }
        
        .view-toggle {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: #4a89dc;
            color: white;
        }
        
        .btn-secondary {
            background-color: #e9ecef;
            color: #495057;
        }
        
        .btn-success {
            background-color: #5cb85c;
            color: white;
        }
        
        .btn-danger {
            background-color: #d9534f;
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .section {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .section-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: #4a89dc;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .hidden {
            display: none;
        }
        
        .ride-card {
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: #f8f9fa;
        }
        
        .ride-info {
            margin-bottom: 10px;
        }
        
        .fare-display {
            font-size: 24px;
            font-weight: bold;
            color: #4a89dc;
            text-align: center;
            margin: 20px 0;
        }
        
        .status-bar {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            margin: 15px 0;
            font-weight: 500;
        }
        
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-accepted {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-completed {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .map-container {
            height: 300px;
            background-color: #e9ecef;
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #6c757d;
        }
        
        .driver-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .driver-card {
            background-color: white;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .driver-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .driver-rating {
            color: #f0ad4e;
            margin-bottom: 10px;
        }
        
        .active-ride {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        
        @media (max-width: 768px) {
            .driver-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">RideEase</div>
            <div class="view-toggle">
                <button id="customerViewBtn" class="btn btn-primary">Customer View</button>
                <button id="driverViewBtn" class="btn btn-secondary">Driver View</button>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Customer View -->
        <div id="customerView">
            <div class="section">
                <h2 class="section-title">Book a Ride</h2>
                <div class="form-group">
                    <label for="pickupLocation">Pickup Location</label>
                    <input type="text" id="pickupLocation" placeholder="Enter pickup location">
                </div>
                <div class="form-group">
                    <label for="dropoffLocation">Dropoff Location</label>
                    <input type="text" id="dropoffLocation" placeholder="Enter dropoff location">
                </div>
                <div class="form-group">
                    <label for="rideType">Ride Type</label>
                    <select id="rideType">
                        <option value="standard">Standard (₹10/km + ₹1/min)</option>
                        <option value="premium">Premium (₹15/km + ₹2/min)</option>
                        <option value="shared">Shared (₹7/km + ₹0.5/min)</option>
                    </select>
                </div>
                <button id="calculateFareBtn" class="btn btn-primary">Calculate Fare</button>
            </div>

            <div id="fareResult" class="section hidden">
                <h2 class="section-title">Your Fare Estimate</h2>
                <div id="fareDisplay" class="fare-display">₹0.00</div>
                <button id="requestRideBtn" class="btn btn-success" style="width: 100%;">Request Ride</button>
            </div>

            <div id="rideStatus" class="section hidden">
                <h2 class="section-title">Ride Status</h2>
                <div id="statusMessage" class="status-bar status-pending">Waiting for driver assignment...</div>
                <div class="map-container">
                    Simulated Map - Your ride is being processed
                </div>
                <div id="driverInfo" class="hidden">
                    <h3>Your Driver</h3>
                    <div class="ride-card">
                        <div class="driver-name" id="assignedDriverName">Driver Name</div>
                        <div class="driver-rating" id="assignedDriverRating">Rating: 4.8</div>
                        <div>Vehicle: <span id="assignedVehicle">Tata Magic</span></div>
                        <div>License: <span id="assignedLicense">DL01AB1234</span></div>
                    </div>
                </div>
                <button id="completeRideBtn" class="btn btn-success hidden" style="width: 100%;">Complete Ride</button>
            </div>

            <div id="rideCompleted" class="section hidden">
                <h2 class="section-title">Ride Completed</h2>
                <div class="status-bar status-completed">Thank you for riding with us!</div>
                <div class="fare-display">Final Fare: <span id="finalFare">₹0.00</span></div>
                <p>Your ride data has been cleared from the system.</p>
                <button id="newRideBtn" class="btn btn-primary">Book New Ride</button>
            </div>
        </div>

        <!-- Driver View -->
        <div id="driverView" class="hidden">
            <div class="section">
                <h2 class="section-title">Available Ride Requests</h2>
                <div id="rideRequestsList"></div>
            </div>

            <div id="acceptedRide" class="section hidden">
                <h2 class="section-title">Current Ride</h2>
                <div id="currentRideInfo"></div>
                <div class="map-container">
                    Simulated Navigation Map
                </div>
                <button id="startRideBtn" class="btn btn-primary">Start Ride</button>
                <button id="endRideBtn" class="btn btn-success hidden">End Ride</button>
            </div>

            <div id="noRides" class="section">
                <p>No active ride requests at the moment. Please check back later.</p>
            </div>
        </div>
    </div>

    <script>
        // Application state
        const state = {
            currentView: 'customer',
            rideRequests: JSON.parse(localStorage.getItem('rideRequests')) || [],
            drivers: [
                { id: 1, name: "Rajesh Kumar", vehicle: "Tata Magic", license: "DL01AB1234", rating: 4.8, available: true },
                { id: 2, name: "Suresh Singh", vehicle: "Mahindra Supro", license: "DL02CD5678", rating: 4.6, available: true },
                { id: 3, name: "Anil Patel", vehicle: "Bajaj Qute", license: "DL03EF9012", rating: 4.9, available: true }
            ],
            currentRide: JSON.parse(localStorage.getItem('currentRide')) || null
        };

        // DOM Elements
        const customerView = document.getElementById('customerView');
        const driverView = document.getElementById('driverView');
        const customerViewBtn = document.getElementById('customerViewBtn');
        const driverViewBtn = document.getElementById('driverViewBtn');
        
        // Customer view elements
        const fareResult = document.getElementById('fareResult');
        const rideStatus = document.getElementById('rideStatus');
        const rideCompleted = document.getElementById('rideCompleted');
        const calculateFareBtn = document.getElementById('calculateFareBtn');
        const requestRideBtn = document.getElementById('requestRideBtn');
        const completeRideBtn = document.getElementById('completeRideBtn');
        const newRideBtn = document.getElementById('newRideBtn');
        const fareDisplay = document.getElementById('fareDisplay');
        const finalFare = document.getElementById('finalFare');
        const statusMessage = document.getElementById('statusMessage');
        const driverInfo = document.getElementById('driverInfo');
        const assignedDriverName = document.getElementById('assignedDriverName');
        const assignedDriverRating = document.getElementById('assignedDriverRating');
        const assignedVehicle = document.getElementById('assignedVehicle');
        const assignedLicense = document.getElementById('assignedLicense');
        
        // Driver view elements
        const rideRequestsList = document.getElementById('rideRequestsList');
        const acceptedRide = document.getElementById('acceptedRide');
        const noRides = document.getElementById('noRides');
        const currentRideInfo = document.getElementById('currentRideInfo');
        const startRideBtn = document.getElementById('startRideBtn');
        const endRideBtn = document.getElementById('endRideBtn');

        // Initialize the application
        function init() {
            updateViews();
            attachEventListeners();
            checkExistingRide();
        }

        // Update views based on current state
        function updateViews() {
            // Show/hide customer/driver views
            if (state.currentView === 'customer') {
                customerView.style.display = 'block';
                driverView.style.display = 'none';
                customerViewBtn.classList.add('btn-primary');
                customerViewBtn.classList.remove('btn-secondary');
                driverViewBtn.classList.remove('btn-primary');
                driverViewBtn.classList.add('btn-secondary');
            } else {
                customerView.style.display = 'none';
                driverView.style.display = 'block';
                driverViewBtn.classList.add('btn-primary');
                driverViewBtn.classList.remove('btn-secondary');
                customerViewBtn.classList.remove('btn-primary');
                customerViewBtn.classList.add('btn-secondary');
                updateDriverView();
            }
        }

        // Check if there's an existing ride in progress
        function checkExistingRide() {
            if (state.currentRide) {
                if (state.currentRide.status === 'requested') {
                    showElement(fareResult);
                    hideElement(rideStatus);
                    hideElement(rideCompleted);
                } else if (state.currentRide.status === 'accepted') {
                    hideElement(fareResult);
                    showElement(rideStatus);
                    hideElement(rideCompleted);
                    statusMessage.textContent = 'Driver is on the way';
                    statusMessage.className = 'status-bar status-accepted';
                    showElement(driverInfo);
                    
                    // Find driver info
                    const driver = state.drivers.find(d => d.id === state.currentRide.driverId);
                    if (driver) {
                        assignedDriverName.textContent = driver.name;
                        assignedDriverRating.textContent = `Rating: ${driver.rating}`;
                        assignedVehicle.textContent = driver.vehicle;
                        assignedLicense.textContent = driver.license;
                    }
                } else if (state.currentRide.status === 'completed') {
                    hideElement(fareResult);
                    hideElement(rideStatus);
                    showElement(rideCompleted);
                    finalFare.textContent = `₹${state.currentRide.fare.toFixed(2)}`;
                }
            }
        }

        // Update the driver view with current ride requests
        function updateDriverView() {
            // Clear previous content
            rideRequestsList.innerHTML = '';
            
            // Filter available ride requests
            const availableRequests = state.rideRequests.filter(ride => ride.status === 'requested');
            
            if (availableRequests.length > 0) {
                showElement(rideRequestsList);
                hideElement(noRides);
                
                availableRequests.forEach(ride => {
                    const rideElement = document.createElement('div');
                    rideElement.className = 'ride-card';
                    rideElement.innerHTML = `
                        <div class="ride-info">
                            <strong>From:</strong> ${ride.pickup}<br>
                            <strong>To:</strong> ${ride.dropoff}<br>
                            <strong>Fare:</strong> ₹${ride.fare.toFixed(2)}<br>
                            <strong>Ride Type:</strong> ${ride.type}
                        </div>
                        <button class="btn btn-primary accept-ride" data-id="${ride.id}">Accept Ride</button>
                    `;
                    rideRequestsList.appendChild(rideElement);
                });
                
                // Add event listeners to accept buttons
                document.querySelectorAll('.accept-ride').forEach(button => {
                    button.addEventListener('click', function() {
                        const rideId = this.getAttribute('data-id');
                        acceptRide(rideId);
                    });
                });
            } else {
                hideElement(rideRequestsList);
                showElement(noRides);
            }
            
            // Check if driver has an accepted ride
            const driverRide = state.rideRequests.find(ride => 
                ride.status === 'accepted' || ride.status === 'started'
            );
            
            if (driverRide) {
                showElement(acceptedRide);
                currentRideInfo.innerHTML = `
                    <div class="ride-info">
                        <strong>From:</strong> ${driverRide.pickup}<br>
                        <strong>To:</strong> ${driverRide.dropoff}<br>
                        <strong>Estimated Fare:</strong> ₹${driverRide.fare.toFixed(2)}<br>
                        <strong>Ride Type:</strong> ${driverRide.type}
                    </div>
                `;
                
                if (driverRide.status === 'accepted') {
                    showElement(startRideBtn);
                    hideElement(endRideBtn);
                } else if (driverRide.status === 'started') {
                    hideElement(startRideBtn);
                    showElement(endRideBtn);
                }
            } else {
                hideElement(acceptedRide);
            }
        }

        // Calculate fare based on distance and ride type
        function calculateFare() {
            const pickup = document.getElementById('pickupLocation').value;
            const dropoff = document.getElementById('dropoffLocation').value;
            const rideType = document.getElementById('rideType').value;
            
            if (!pickup || !dropoff) {
                alert('Please enter both pickup and dropoff locations');
                return;
            }
            
            // Simulate distance calculation (in real app, would use maps API)
            const distance = Math.random() * 10 + 2; // 2-12 km
            const time = distance * 4; // 4 minutes per km
            
            let baseRate, timeRate;
            switch(rideType) {
                case 'standard':
                    baseRate = 10;
                    timeRate = 1;
                    break;
                case 'premium':
                    baseRate = 15;
                    timeRate = 2;
                    break;
                case 'shared':
                    baseRate = 7;
                    timeRate = 0.5;
                    break;
                default:
                    baseRate = 10;
                    timeRate = 1;
            }
            
            const fare = (distance * baseRate) + (time * timeRate);
            fareDisplay.textContent = `₹${fare.toFixed(2)}`;
            showElement(fareResult);
            
            // Store calculated fare for later use
            state.calculatedFare = fare;
        }

        // Request a ride
        function requestRide() {
            const pickup = document.getElementById('pickupLocation').value;
            const dropoff = document.getElementById('dropoffLocation').value;
            const rideType = document.getElementById('rideType').value;
            const fare = state.calculatedFare;
            
            const rideRequest = {
                id: Date.now(), // Unique ID
                pickup,
                dropoff,
                type: rideType,
                fare,
                status: 'requested',
                timestamp: new Date()
            };
            
            // Add to ride requests
            state.rideRequests.push(rideRequest);
            localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
            
            // Update UI
            hideElement(fareResult);
            showElement(rideStatus);
            
            // Simulate driver assignment
            setTimeout(assignDriver, 3000);
        }

        // Assign a driver to the ride
        function assignDriver() {
            // Find the latest ride request
            const rideRequest = state.rideRequests[state.rideRequests.length - 1];
            
            // Find an available driver
            const availableDriver = state.drivers.find(driver => driver.available);
            
            if (availableDriver) {
                // Update ride request
                rideRequest.status = 'accepted';
                rideRequest.driverId = availableDriver.id;
                rideRequest.driverName = availableDriver.name;
                
                // Update driver availability
                availableDriver.available = false;
                
                // Update state and storage
                state.currentRide = rideRequest;
                localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
                localStorage.setItem('currentRide', JSON.stringify(state.currentRide));
                
                // Update UI
                statusMessage.textContent = 'Driver is on the way';
                statusMessage.className = 'status-bar status-accepted';
                showElement(driverInfo);
                
                // Show driver info
                assignedDriverName.textContent = availableDriver.name;
                assignedDriverRating.textContent = `Rating: ${availableDriver.rating}`;
                assignedVehicle.textContent = availableDriver.vehicle;
                assignedLicense.textContent = availableDriver.license;
                
                showElement(completeRideBtn);
            }
        }

        // Accept a ride (driver perspective)
        function acceptRide(rideId) {
            const rideIndex = state.rideRequests.findIndex(ride => ride.id === parseInt(rideId));
            
            if (rideIndex !== -1) {
                // Find an available driver (in real app, would be the logged-in driver)
                const availableDriver = state.drivers.find(driver => driver.available);
                
                if (availableDriver) {
                    // Update ride request
                    state.rideRequests[rideIndex].status = 'accepted';
                    state.rideRequests[rideIndex].driverId = availableDriver.id;
                    state.rideRequests[rideIndex].driverName = availableDriver.name;
                    
                    // Update driver availability
                    availableDriver.available = false;
                    
                    // Update storage
                    localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
                    
                    // Update UI
                    updateDriverView();
                }
            }
        }

        // Start the ride (driver)
        function startRide() {
            const activeRide = state.rideRequests.find(ride => ride.status === 'accepted');
            
            if (activeRide) {
                activeRide.status = 'started';
                localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
                updateDriverView();
            }
        }

        // End the ride (driver)
        function endRide() {
            const activeRideIndex = state.rideRequests.findIndex(ride => 
                ride.status === 'started' || ride.status === 'accepted'
            );
            
            if (activeRideIndex !== -1) {
                state.rideRequests[activeRideIndex].status = 'completed';
                
                // Make driver available again
                const driverId = state.rideRequests[activeRideIndex].driverId;
                const driver = state.drivers.find(d => d.id === driverId);
                if (driver) {
                    driver.available = true;
                }
                
                // Update current ride
                state.currentRide = state.rideRequests[activeRideIndex];
                localStorage.setItem('currentRide', JSON.stringify(state.currentRide));
                
                // Remove from active requests (simulating data deletion after trip)
                state.rideRequests.splice(activeRideIndex, 1);
                localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
                
                // Update UI
                updateDriverView();
                
                // If in customer view, show completion
                if (state.currentView === 'customer') {
                    hideElement(rideStatus);
                    showElement(rideCompleted);
                    finalFare.textContent = `₹${state.currentRide.fare.toFixed(2)}`;
                }
            }
        }

        // Complete the ride (customer)
        function completeRide() {
            // This would typically be triggered by the driver, but we'll simulate it
            endRide();
        }

        // Start a new ride
        function newRide() {
            // Clear form fields
            document.getElementById('pickupLocation').value = '';
            document.getElementById('dropoffLocation').value = '';
            document.getElementById('rideType').value = 'standard';
            
            // Reset UI
            hideElement(rideCompleted);
            hideElement(rideStatus);
            hideElement(fareResult);
            
            // Clear current ride from storage
            localStorage.removeItem('currentRide');
            state.currentRide = null;
        }

        // Helper functions
        function showElement(element) {
            element.classList.remove('hidden');
        }
        
        function hideElement(element) {
            element.classList.add('hidden');
        }

        // Attach event listeners
        function attachEventListeners() {
            // View toggle
            customerViewBtn.addEventListener('click', () => {
                state.currentView = 'customer';
                updateViews();
            });
            
            driverViewBtn.addEventListener('click', () => {
                state.currentView = 'driver';
                updateViews();
            });
            
            // Customer actions
            calculateFareBtn.addEventListener('click', calculateFare);
            requestRideBtn.addEventListener('click', requestRide);
            completeRideBtn.addEventListener('click', completeRide);
            newRideBtn.addEventListener('click', newRide);
            
            // Driver actions
            startRideBtn.addEventListener('click', startRide);
            endRideBtn.addEventListener('click', endRide);
        }

        // Initialize the app
        init();
    </script>
</body>
</html>
