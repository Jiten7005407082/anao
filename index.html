<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RideEase - E-Rickshaw & E-Auto Booking</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary: #4a89dc;
            --secondary: #5d9cec;
            --accent: #ffce54;
            --success: #a0d468;
            --danger: #ed5565;
            --dark: #434a54;
            --light: #f5f7fa;
            --grey: #ccd1d9;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 15px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: bold;
        }
        
        .logo i {
            color: var(--accent);
        }
        
        .nav {
            display: flex;
            gap: 20px;
        }
        
        .nav-item {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
        }
        
        .nav-item:hover, .nav-item.active {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .section {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            margin-top: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        
        .section-title {
            font-size: 22px;
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--grey);
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(74, 137, 220, 0.2);
        }
        
        .hidden {
            display: none;
        }
        
        .card {
            border: 1px solid var(--grey);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            background-color: white;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.08);
        }
        
        .ride-info {
            margin-bottom: 15px;
        }
        
        .fare-display {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary);
            text-align: center;
            margin: 25px 0;
            padding: 15px;
            background-color: var(--light);
            border-radius: 12px;
        }
        
        .status-bar {
            background-color: var(--light);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
            font-weight: 500;
        }
        
        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-accepted {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-completed {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .map-container {
            height: 350px;
            background: linear-gradient(rgba(74, 137, 220, 0.1), rgba(74, 137, 220, 0.2)), url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 100 100"><rect width="100%" height="100%" fill="%23f8f9fa"/><path d="M0,0 L100,100 M100,0 L0,100" stroke="%23ccd1d9" stroke-width="0.5"/></svg>');
            background-size: cover;
            border-radius: 12px;
            margin: 25px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--dark);
            flex-direction: column;
            gap: 15px;
        }
        
        .driver-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .driver-card {
            background-color: white;
            border: 1px solid var(--grey);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .driver-card:hover {
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }
        
        .driver-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 15px;
            border: 3px solid var(--primary);
        }
        
        .driver-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .driver-rating {
            color: #f0ad4e;
            margin-bottom: 10px;
        }
        
        .driver-vehicle {
            background-color: var(--light);
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .active-ride {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        
        .vehicle-badge {
            background-color: var(--primary);
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 12px;
            margin-left: 8px;
        }
        
        .tab-container {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            background-color: var(--light);
            padding: 5px;
            border-radius: 50px;
        }
        
        .tab {
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            text-align: center;
            flex: 1;
            transition: all 0.3s;
        }
        
        .tab.active {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .icon-input {
            position: relative;
        }
        
        .icon-input i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--dark);
        }
        
        .icon-input input {
            padding-left: 45px;
        }
        
        @media (max-width: 768px) {
            .driver-list {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav {
                width: 100%;
                justify-content: center;
            }
        }
        
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 60px 0;
            text-align: center;
            border-radius: 0 0 20px 20px;
            margin-bottom: 30px;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 30px;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .feature-card {
            background-color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .feature-card i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        footer {
            background-color: var(--dark);
            color: white;
            padding: 40px 0;
            margin-top: 60px;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-taxi"></i>
                <span>RideEase</span>
            </div>
            <div class="nav">
                <a href="#" class="nav-item active" id="customerNav">Customer</a>
                <a href="#" class="nav-item" id="driverNav">Driver</a>
                <a href="#" class="nav-item" id="registerNav">Register</a>
            </div>
        </div>
    </header>

    <div class="hero">
        <div class="container">
            <h1>Book E-Rickshaws & E-Autos Instantly</h1>
            <p>Affordable, eco-friendly rides at your fingertips. Download our app or book directly on the web.</p>
            <button class="btn btn-success"><i class="fas fa-download"></i> Download App</button>
        </div>
    </div>

    <div class="container">
        <!-- Customer View -->
        <div id="customerView">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-map-marker-alt"></i> Book a Ride</h2>
                <div class="tab-container">
                    <div class="tab active" data-vehicle="e-rickshaw">E-Rickshaw</div>
                    <div class="tab" data-vehicle="e-auto">E-Auto</div>
                </div>
                <div class="form-group icon-input">
                    <i class="fas fa-location-arrow"></i>
                    <input type="text" id="pickupLocation" placeholder="Enter pickup location">
                </div>
                <div class="form-group icon-input">
                    <i class="fas fa-map-pin"></i>
                    <input type="text" id="dropoffLocation" placeholder="Enter dropoff location">
                </div>
                <button id="calculateFareBtn" class="btn btn-primary" style="width: 100%;"><i class="fas fa-calculator"></i> Calculate Fare</button>
            </div>

            <div id="fareResult" class="section hidden">
                <h2 class="section-title"><i class="fas fa-receipt"></i> Your Fare Estimate</h2>
                <div id="fareDisplay" class="fare-display">₹0.00</div>
                <button id="requestRideBtn" class="btn btn-success" style="width: 100%;"><i class="fas fa-taxi"></i> Request Ride</button>
            </div>

            <div id="rideStatus" class="section hidden">
                <h2 class="section-title"><i class="fas fa-spinner fa-spin"></i> Ride Status</h2>
                <div id="statusMessage" class="status-bar status-pending">Waiting for driver assignment...</div>
                <div class="map-container">
                    <i class="fas fa-map-marked-alt" style="font-size: 48px;"></i>
                    <p>Simulated Map - Your ride is being processed</p>
                </div>
                <div id="driverInfo" class="hidden">
                    <h3>Your Driver</h3>
                    <div class="driver-card">
                        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'><rect width='80' height='80' fill='%234a89dc'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-size='32' fill='white'>DR</text></svg>" class="driver-avatar" alt="Driver">
                        <div class="driver-name" id="assignedDriverName">Rajesh Kumar</div>
                        <div class="driver-rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                            4.5
                        </div>
                        <div class="driver-vehicle">
                            <i class="fas fa-taxi"></i> 
                            <span id="assignedVehicle">E-Rickshaw</span>
                        </div>
                        <div>License: <span id="assignedLicense">DL01AB1234</span></div>
                    </div>
                </div>
                <button id="completeRideBtn" class="btn btn-success hidden" style="width: 100%;"><i class="fas fa-check-circle"></i> Complete Ride</button>
            </div>

            <div id="rideCompleted" class="section hidden">
                <h2 class="section-title"><i class="fas fa-check-circle"></i> Ride Completed</h2>
                <div class="status-bar status-completed">Thank you for riding with us!</div>
                <div class="fare-display">Final Fare: <span id="finalFare">₹0.00</span></div>
                <p>Your ride data has been cleared from the system.</p>
                <button id="newRideBtn" class="btn btn-primary"><i class="fas fa-plus"></i> Book New Ride</button>
            </div>
        </div>

        <!-- Driver View -->
        <div id="driverView" class="hidden">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-list"></i> Available Ride Requests</h2>
                <div id="rideRequestsList"></div>
                <div id="noRides" class="section">
                    <p>No active ride requests at the moment. Please check back later.</p>
                </div>
            </div>

            <div id="acceptedRide" class="section hidden">
                <h2 class="section-title"><i class="fas fa-road"></i> Current Ride</h2>
                <div id="currentRideInfo"></div>
                <div class="map-container">
                    <i class="fas fa-map-marked-alt" style="font-size: 48px;"></i>
                    <p>Simulated Navigation Map</p>
                </div>
                <button id="startRideBtn" class="btn btn-primary"><i class="fas fa-play-circle"></i> Start Ride</button>
                <button id="endRideBtn" class="btn btn-success hidden"><i class="fas fa-flag-checkered"></i> End Ride</button>
            </div>
        </div>

        <!-- Registration View -->
        <div id="registerView" class="hidden">
            <div class="section">
                <h2 class="section-title"><i class="fas fa-user-plus"></i> Driver Registration</h2>
                <p>Register as a driver to start accepting rides on our platform.</p>
                
                <div class="form-group">
                    <label for="driverName">Full Name</label>
                    <input type="text" id="driverName" placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label for="driverEmail">Email Address</label>
                    <input type="email" id="driverEmail" placeholder="Enter your email">
                </div>
                
                <div class="form-group">
                    <label for="driverPhone">Phone Number</label>
                    <input type="tel" id="driverPhone" placeholder="Enter your phone number">
                </div>
                
                <div class="form-group">
                    <label for="vehicleType">Vehicle Type</label>
                    <select id="vehicleType">
                        <option value="">Select your vehicle type</option>
                        <option value="e-rickshaw">E-Rickshaw</option>
                        <option value="e-auto">E-Auto</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="vehicleNumber">Vehicle Number</label>
                    <input type="text" id="vehicleNumber" placeholder="Enter your vehicle number">
                </div>
                
                <div class="form-group">
                    <label for="licenseNumber">License Number</label>
                    <input type="text" id="licenseNumber" placeholder="Enter your license number">
                </div>
                
                <button id="registerDriverBtn" class="btn btn-success" style="width: 100%;"><i class="fas fa-check"></i> Register as Driver</button>
                
                <div id="registrationSuccess" class="status-bar status-completed hidden">
                    Registration successful! You can now log in as a driver.
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="features">
            <div class="feature-card">
                <i class="fas fa-bolt"></i>
                <h3>Eco-Friendly Rides</h3>
                <p>Zero emissions with our electric vehicles</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-rupee-sign"></i>
                <h3>Affordable Pricing</h3>
                <p>Get where you need to go without breaking the bank</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-clock"></i>
                <h3>Quick Pickups</h3>
                <p>Average wait time of less than 5 minutes</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-shield-alt"></i>
                <h3>Safe Travel</h3>
                <p>All drivers are verified and trained</p>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>© 2023 RideEase - Eco-Friendly E-Rickshaw & E-Auto Hailing Service</p>
            <p>Data is temporarily stored and deleted after ride completion for privacy</p>
        </div>
    </footer>

    <script>
        // Application state
        const state = {
            currentView: 'customer',
            rideRequests: JSON.parse(localStorage.getItem('rideRequests')) || [],
            drivers: JSON.parse(localStorage.getItem('drivers')) || [
                { id: 1, name: "Rajesh Kumar", vehicle: "E-Rickshaw", license: "DL01AB1234", rating: 4.5, available: true },
                { id: 2, name: "Suresh Singh", vehicle: "E-Auto", license: "DL02CD5678", rating: 4.7, available: true },
                { id: 3, name: "Anil Patel", vehicle: "E-Rickshaw", license: "DL03EF9012", rating: 4.8, available: true }
            ],
            currentRide: JSON.parse(localStorage.getItem('currentRide')) || null,
            selectedVehicle: 'e-rickshaw'
        };

        // DOM Elements
        const customerView = document.getElementById('customerView');
        const driverView = document.getElementById('driverView');
        const registerView = document.getElementById('registerView');
        const customerNav = document.getElementById('customerNav');
        const driverNav = document.getElementById('driverNav');
        const registerNav = document.getElementById('registerNav');
        
        // Customer view elements
        const fareResult = document.getElementById('fareResult');
        const rideStatus = document.getElementById('rideStatus');
        const rideCompleted = document.getElementById('rideCompleted');
        const calculateFareBtn = document.getElementById('calculateFareBtn');
        const requestRideBtn = document.getElementById('requestRideBtn');
        const completeRideBtn = document.getElementById('completeRideBtn');
        const newRideBtn = document.getElementById('newRideBtn');
        const fareDisplay = document.getElementById('fareDisplay');
        const finalFare = document.getElementById('finalFare');
        const statusMessage = document.getElementById('statusMessage');
        const driverInfo = document.getElementById('driverInfo');
        const assignedDriverName = document.getElementById('assignedDriverName');
        const assignedVehicle = document.getElementById('assignedVehicle');
        const assignedLicense = document.getElementById('assignedLicense');
        
        // Driver view elements
        const rideRequestsList = document.getElementById('rideRequestsList');
        const acceptedRide = document.getElementById('acceptedRide');
        const noRides = document.getElementById('noRides');
        const currentRideInfo = document.getElementById('currentRideInfo');
        const startRideBtn = document.getElementById('startRideBtn');
        const endRideBtn = document.getElementById('endRideBtn');
        
        // Registration view elements
        const registerDriverBtn = document.getElementById('registerDriverBtn');
        const registrationSuccess = document.getElementById('registrationSuccess');
        
        // Tabs
        const tabs = document.querySelectorAll('.tab');

        // Initialize the application
        function init() {
            updateViews();
            attachEventListeners();
            checkExistingRide();
            
            // Set up tab selection
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    state.selectedVehicle = tab.getAttribute('data-vehicle');
                });
            });
        }

        // Update views based on current state
        function updateViews() {
            // Show/hide customer/driver/register views
            customerView.style.display = state.currentView === 'customer' ? 'block' : 'none';
            driverView.style.display = state.currentView === 'driver' ? 'block' : 'none';
            registerView.style.display = state.currentView === 'register' ? 'block' : 'none';
            
            // Update nav highlights
            customerNav.classList.toggle('active', state.currentView === 'customer');
            driverNav.classList.toggle('active', state.currentView === 'driver');
            registerNav.classList.toggle('active', state.currentView === 'register');
            
            if (state.currentView === 'driver') {
                updateDriverView();
            }
        }

        // Check if there's an existing ride in progress
        function checkExistingRide() {
            if (state.currentRide) {
                if (state.currentRide.status === 'requested') {
                    showElement(fareResult);
                    hideElement(rideStatus);
                    hideElement(rideCompleted);
                } else if (state.currentRide.status === 'accepted') {
                    hideElement(fareResult);
                    showElement(rideStatus);
                    hideElement(rideCompleted);
                    statusMessage.textContent = 'Driver is on the way';
                    statusMessage.className = 'status-bar status-accepted';
                    showElement(driverInfo);
                    
                    // Find driver info
                    const driver = state.drivers.find(d => d.id === state.currentRide.driverId);
                    if (driver) {
                        assignedDriverName.textContent = driver.name;
                        assignedVehicle.textContent = driver.vehicle;
                        assignedLicense.textContent = driver.license;
                    }
                    
                    showElement(completeRideBtn);
                } else if (state.currentRide.status === 'completed') {
                    hideElement(fareResult);
                    hideElement(rideStatus);
                    showElement(rideCompleted);
                    finalFare.textContent = `₹${state.currentRide.fare.toFixed(2)}`;
                }
            }
        }

        // Update the driver view with current ride requests
        function updateDriverView() {
            // Clear previous content
            rideRequestsList.innerHTML = '';
            
            // Filter available ride requests
            const availableRequests = state.rideRequests.filter(ride => ride.status === 'requested');
            
            if (availableRequests.length > 0) {
                showElement(rideRequestsList);
                hideElement(noRides);
                
                availableRequests.forEach(ride => {
                    const rideElement = document.createElement('div');
                    rideElement.className = 'ride-card';
                    rideElement.innerHTML = `
                        <div class="ride-info">
                            <strong>From:</strong> ${ride.pickup}<br>
                            <strong>To:</strong> ${ride.dropoff}<br>
                            <strong>Fare:</strong> ₹${ride.fare.toFixed(2)}<br>
                            <strong>Vehicle:</strong> ${ride.vehicleType}
                        </div>
                        <button class="btn btn-primary accept-ride" data-id="${ride.id}">
                            <i class="fas fa-check-circle"></i> Accept Ride
                        </button>
                    `;
                    rideRequestsList.appendChild(rideElement);
                });
                
                // Add event listeners to accept buttons
                document.querySelectorAll('.accept-ride').forEach(button => {
                    button.addEventListener('click', function() {
                        const rideId = this.getAttribute('data-id');
                        acceptRide(rideId);
                    });
                });
            } else {
                hideElement(rideRequestsList);
                showElement(noRides);
            }
            
            // Check if driver has an accepted ride
            const driverRide = state.rideRequests.find(ride => 
                ride.status === 'accepted' || ride.status === 'started'
            );
            
            if (driverRide) {
                showElement(acceptedRide);
                currentRideInfo.innerHTML = `
                    <div class="ride-info">
                        <strong>From:</strong> ${driverRide.pickup}<br>
                        <strong>To:</strong> ${driverRide.dropoff}<br>
                        <strong>Estimated Fare:</strong> ₹${driverRide.fare.toFixed(2)}<br>
                        <strong>Vehicle Type:</strong> ${driverRide.vehicleType}
                    </div>
                `;
                
                if (driverRide.status === 'accepted') {
                    showElement(startRideBtn);
                    hideElement(endRideBtn);
                } else if (driverRide.status === 'started') {
                    hideElement(startRideBtn);
                    showElement(endRideBtn);
                }
            } else {
                hideElement(acceptedRide);
            }
        }

        // Calculate fare based on distance and vehicle type
        function calculateFare() {
            const pickup = document.getElementById('pickupLocation').value;
            const dropoff = document.getElementById('dropoffLocation').value;
            
            if (!pickup || !dropoff) {
                alert('Please enter both pickup and dropoff locations');
                return;
            }
            
            // Simulate distance calculation (in real app, would use maps API)
            const distance = Math.random() * 8 + 2; // 2-10 km
            const time = distance * 4; // 4 minutes per km
            
            let baseRate, kmRate, timeRate;
            if (state.selectedVehicle === 'e-rickshaw') {
                baseRate = 20;
                kmRate = 8;
                timeRate = 0.5;
            } else { // e-auto
                baseRate = 25;
                kmRate = 10;
                timeRate = 1;
            }
            
            const fare = baseRate + (distance * kmRate) + (time * timeRate);
            fareDisplay.textContent = `₹${fare.toFixed(2)}`;
            showElement(fareResult);
            
            // Store calculated fare for later use
            state.calculatedFare = fare;
            state.calculatedDistance = distance;
        }

        // Request a ride
        function requestRide() {
            const pickup = document.getElementById('pickupLocation').value;
            const dropoff = document.getElementById('dropoffLocation').value;
            const fare = state.calculatedFare;
            const distance = state.calculatedDistance;
            
            const rideRequest = {
                id: Date.now(), // Unique ID
                pickup,
                dropoff,
                vehicleType: state.selectedVehicle === 'e-rickshaw' ? 'E-Rickshaw' : 'E-Auto',
                fare,
                distance,
                status: 'requested',
                timestamp: new Date()
            };
            
            // Add to ride requests
            state.rideRequests.push(rideRequest);
            localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
            
            // Update UI
            hideElement(fareResult);
            showElement(rideStatus);
            
            // Simulate driver assignment
            setTimeout(assignDriver, 3000);
        }

        // Assign a driver to the ride
        function assignDriver() {
            // Find the latest ride request
            const rideRequest = state.rideRequests[state.rideRequests.length - 1];
            
            // Find an available driver with matching vehicle type
            const availableDriver = state.drivers.find(driver => 
                driver.available && 
                driver.vehicle.toLowerCase() === rideRequest.vehicleType.toLowerCase()
            );
            
            if (availableDriver) {
                // Update ride request
                rideRequest.status = 'accepted';
                rideRequest.driverId = availableDriver.id;
                rideRequest.driverName = availableDriver.name;
                
                // Update driver availability
                availableDriver.available = false;
                
                // Update state and storage
                state.currentRide = rideRequest;
                localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
                localStorage.setItem('currentRide', JSON.stringify(state.currentRide));
                localStorage.setItem('drivers', JSON.stringify(state.drivers));
                
                // Update UI
                statusMessage.textContent = 'Driver is on the way';
                statusMessage.className = 'status-bar status-accepted';
                showElement(driverInfo);
                
                // Show driver info
                assignedDriverName.textContent = availableDriver.name;
                assignedVehicle.textContent = availableDriver.vehicle;
                assignedLicense.textContent = availableDriver.license;
                
                showElement(completeRideBtn);
            } else {
                // If no driver available, try again in 5 seconds
                statusMessage.textContent = 'Looking for available drivers...';
                setTimeout(assignDriver, 5000);
            }
        }

        // Accept a ride (driver perspective)
        function acceptRide(rideId) {
            const rideIndex = state.rideRequests.findIndex(ride => ride.id === parseInt(rideId));
            
            if (rideIndex !== -1) {
                // Find an available driver (in real app, would be the logged-in driver)
                const availableDriver = state.drivers.find(driver => 
                    driver.available && 
                    driver.vehicle.toLowerCase() === state.rideRequests[rideIndex].vehicleType.toLowerCase()
                );
                
                if (availableDriver) {
                    // Update ride request
                    state.rideRequests[rideIndex].status = 'accepted';
                    state.rideRequests[rideIndex].driverId = availableDriver.id;
                    state.rideRequests[rideIndex].driverName = availableDriver.name;
                    
                    // Update driver availability
                    availableDriver.available = false;
                    
                    // Update storage
                    localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
                    localStorage.setItem('drivers', JSON.stringify(state.drivers));
                    
                    // Update UI
                    updateDriverView();
                }
            }
        }

        // Start the ride (driver)
        function startRide() {
            const activeRide = state.rideRequests.find(ride => ride.status === 'accepted');
            
            if (activeRide) {
                activeRide.status = 'started';
                localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
                updateDriverView();
            }
        }

        // End the ride (driver)
        function endRide() {
            const activeRideIndex = state.rideRequests.findIndex(ride => 
                ride.status === 'started' || ride.status === 'accepted'
            );
            
            if (activeRideIndex !== -1) {
                state.rideRequests[activeRideIndex].status = 'completed';
                
                // Make driver available again
                const driverId = state.rideRequests[activeRideIndex].driverId;
                const driver = state.drivers.find(d => d.id === driverId);
                if (driver) {
                    driver.available = true;
                }
                
                // Update current ride
                state.currentRide = state.rideRequests[activeRideIndex];
                localStorage.setItem('currentRide', JSON.stringify(state.currentRide));
                
                // Remove from active requests (simulating data deletion after trip)
                state.rideRequests.splice(activeRideIndex, 1);
                localStorage.setItem('rideRequests', JSON.stringify(state.rideRequests));
                localStorage.setItem('drivers', JSON.stringify(state.drivers));
                
                // Update UI
                updateDriverView();
                
                // If in customer view, show completion
                if (state.currentView === 'customer') {
                    hideElement(rideStatus);
                    showElement(rideCompleted);
                    finalFare.textContent = `₹${state.currentRide.fare.toFixed(2)}`;
                }
            }
        }

        // Complete the ride (customer)
        function completeRide() {
            // This would typically be triggered by the driver, but we'll simulate it
            endRide();
        }

        // Start a new ride
        function newRide() {
            // Clear form fields
            document.getElementById('pickupLocation').value = '';
            document.getElementById('dropoffLocation').value = '';
            
            // Reset UI
            hideElement(rideCompleted);
            hideElement(rideStatus);
            hideElement(fareResult);
            
            // Clear current ride from storage
            localStorage.removeItem('currentRide');
            state.currentRide = null;
        }

        // Register a new driver
        function registerDriver() {
            const name = document.getElementById('driverName').value;
            const email = document.getElementById('driverEmail').value;
            const phone = document.getElementById('driverPhone').value;
            const vehicleType = document.getElementById('vehicleType').value;
            const vehicleNumber = document.getElementById('vehicleNumber').value;
            const licenseNumber = document.getElementById('licenseNumber').value;
            
            if (!name || !email || !phone || !vehicleType || !vehicleNumber || !licenseNumber) {
                alert('Please fill all fields');
                return;
            }
            
            const newDriver = {
                id: Date.now(),
                name,
                email,
                phone,
                vehicle: vehicleType === 'e-rickshaw' ? 'E-Rickshaw' : 'E-Auto',
                vehicleNumber,
                license: licenseNumber,
                rating: (4 + Math.random() * 1).toFixed(1), // Random rating between 4.0 and 5.0
                available: true
            };
            
            // Add to drivers list
            state.drivers.push(newDriver);
            localStorage.setItem('drivers', JSON.stringify(state.drivers));
            
            // Show success message
            showElement(registrationSuccess);
            
            // Clear form
            document.getElementById('driverName').value = '';
            document.getElementById('driverEmail').value = '';
            document.getElementById('driverPhone').value = '';
            document.getElementById('vehicleType').value = '';
            document.getElementById('vehicleNumber').value = '';
            document.getElementById('licenseNumber').value = '';
            
            // Hide success message after 5 seconds
            setTimeout(() => {
                hideElement(registrationSuccess);
            }, 5000);
        }

        // Helper functions
        function showElement(element) {
            element.classList.remove('hidden');
        }
        
        function hideElement(element) {
            element.classList.add('hidden');
        }

        // Attach event listeners
        function attachEventListeners() {
            // View toggle
            customerNav.addEventListener('click', () => {
                state.currentView = 'customer';
                updateViews();
            });
            
            driverNav.addEventListener('click', () => {
                state.currentView = 'driver';
                updateViews();
            });
            
            registerNav.addEventListener('click', () => {
                state.currentView = 'register';
                updateViews();
            });
            
            // Customer actions
            calculateFareBtn.addEventListener('click', calculateFare);
            requestRideBtn.addEventListener('click', requestRide);
            completeRideBtn.addEventListener('click', completeRide);
            newRideBtn.addEventListener('click', newRide);
            
            // Driver actions
            startRideBtn.addEventListener('click', startRide);
            endRideBtn.addEventListener('click', endRide);
            
            // Registration action
            registerDriverBtn.addEventListener('click', registerDriver);
        }

        // Initialize the app
        init();
    </script>
</body>
</html>
