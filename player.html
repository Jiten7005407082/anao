<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Advanced Voice Changer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  font-family: Arial, sans-serif;
  background: #0a1e44;
  color: #fff;
  text-align: center;
  padding: 30px;
}
button, select, input {
  padding: 10px;
  margin: 10px;
  font-size: 16px;
}
select {
  width: 200px;
}
</style>
</head>
<body>

<h1>Advanced Voice Changer</h1>

<button onclick="startAudio()">Start Microphone</button>

<br>

<label>Voice Effect</label><br>
<select id="effect" onchange="changeEffect()">
  <option value="normal">Normal</option>
  <option value="deep">Deep Voice</option>
  <option value="high">High Voice</option>
  <option value="robot">Robot</option>
  <option value="echo">Echo</option>
  <option value="alien">Alien</option>
</select>

<br>

<label>Pitch Control</label><br>
<input type="range" min="0.5" max="2" step="0.1" value="1" id="pitch">

<script>
let audioContext;
let source;
let gainNode;
let delayNode;
let oscillator;
let distortion;
let pitchNode;

async function startAudio() {
  audioContext = new (window.AudioContext || window.webkitAudioContext)();

  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  source = audioContext.createMediaStreamSource(stream);

  gainNode = audioContext.createGain();
  delayNode = audioContext.createDelay();
  pitchNode = audioContext.createPlaybackRate();
  distortion = audioContext.createWaveShaper();

  pitchNode.playbackRate.value = document.getElementById("pitch").value;

  document.getElementById("pitch").oninput = function () {
    pitchNode.playbackRate.value = this.value;
  };

  connectNormal();
}

function clearConnections() {
  source.disconnect();
  gainNode.disconnect();
  delayNode.disconnect();
  if (oscillator) oscillator.disconnect();
}

function connectNormal() {
  clearConnections();
  source.connect(pitchNode).connect(audioContext.destination);
}

function connectDeep() {
  clearConnections();
  pitchNode.playbackRate.value = 0.7;
  source.connect(pitchNode).connect(audioContext.destination);
}

function connectHigh() {
  clearConnections();
  pitchNode.playbackRate.value = 1.5;
  source.connect(pitchNode).connect(audioContext.destination);
}

function connectEcho() {
  clearConnections();
  delayNode.delayTime.value = 0.25;
  gainNode.gain.value = 0.6;

  source.connect(delayNode);
  delayNode.connect(gainNode);
  gainNode.connect(audioContext.destination);
}

function connectRobot() {
  clearConnections();

  oscillator = audioContext.createOscillator();
  oscillator.frequency.value = 30;
  oscillator.start();

  source.connect(distortion);
  distortion.connect(audioContext.destination);
}

function connectAlien() {
  clearConnections();

  oscillator = audioContext.createOscillator();
  oscillator.frequency.value = 15;
  oscillator.start();

  source.connect(oscillator.frequency);
  source.connect(audioContext.destination);
}

function changeEffect() {
  const effect = document.getElementById("effect").value;

  if (effect === "normal") connectNormal();
  if (effect === "deep") connectDeep();
  if (effect === "high") connectHigh();
  if (effect === "robot") connectRobot();
  if (effect === "echo") connectEcho();
  if (effect === "alien") connectAlien();
}
</script>

</body>
</html>
